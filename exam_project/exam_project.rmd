---
title: "R Notebook"
output: html_notebook
---
```{r echo=FALSE, warning=FALSE}
library(readxl)
library(survival)
library(survminer)
```

# Part A
## Question 1

```{r}
std <- read_xlsx('data/std_2019_pw.xlsx')

kmp<-survfit(Surv(std$time,std$cens)~std$type,type="kaplan-meier")

ggsurv <- ggsurvplot(kmp , data = std, xlab="Days to re-infection",
                     ylab="Survival estimate",
                     legend.labs = c("Gonorrhea", "Chlamydia","Both"), linetype = 'strata') + 
  labs(title    = "Survival estimates for time to re-infection",
       subtitle = "Based on Kaplan-Meier estimates")

ggsurv <- ggpar(ggsurv, font.title    = c(14, "bold"),
                font.subtitle = c(12, "bold.italic"),        
                font.x        = c(11, "plain"),          
                font.y        = c(11, "plain"))

print(ggsurv)
```

From Figure 1 we can see that Chlamydia has an overall higher survival rate in terms of re-infection than does Gonorrhea.  A person who has been infected with both appears to lie in between the two singular infections, perhaps being pulled up by the higher survival rate of Chlamydia

## Question 2

```{r}
library(ggfortify)

write.csv(fortify(kmp),file = 'std_summary.csv')

print(0.747803 + (qnorm(0.975,0,1)*0.071121))
print(0.747803  - (qnorm(0.975,0,1)*0.071121))

print(0.484982 + (qnorm(0.975,0,1)*0.33869))
print(0.484982 - (qnorm(0.975,0,1)*0.33869))

print(0.205888 + (qnorm(0.975,0,1)*0.343699))
print(0.205888 - (qnorm(0.975,0,1)*0.343699))

print(0.746184802 + (qnorm(0.975,0,1)*0.045501))
print(0.746184802 - (qnorm(0.975,0,1)*0.045501))

print(0.491433433 + (qnorm(0.975,0,1)*0.106618))
print(0.491433433 - (qnorm(0.975,0,1)*0.106618))

print(0.748251879 + (qnorm(0.975,0,1)*0.043361))
print(0.748251879 - (qnorm(0.975,0,1)*0.043361))

print(0.488086846 + (qnorm(0.975,0,1)*0.092543))
print(0.488086846 - (qnorm(0.975,0,1)*0.092543))

print(0.2395865 + (qnorm(0.975,0,1)*0.23866))
print(0.2395865 - (qnorm(0.975,0,1)*0.23866))
```

Highlight biggest time where S(t) is just smaller than 0.75,0.5,0.25 for each infection type.

## Question 3
```{r}
dif <- survdiff(Surv(std$time,std$cens)~std$type)
```